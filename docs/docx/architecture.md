# Архитектура проекта GameFast

## Общая архитектура

Проект GameFast построен на основе современной клиент-серверной архитектуры с четким разделением на фронтенд и бэкенд:

1. **Клиентская часть (фронтенд)**: Одностраничное приложение (SPA) на React
2. **Серверная часть (бэкенд)**: REST API на ASP.NET Core
3. **База данных**: SQLite (в продакшн-окружении может быть заменена на более мощную СУБД)

### Схема взаимодействия компонентов

```
┌───────────────┐     HTTP/JSON     ┌───────────────┐     Entity      ┌───────────────┐
│               │  ───────────────> │               │  Framework Core │               │
│    Фронтенд   │  <───────────────>│     Бэкенд    │ <──────────────>│ База данных   │
│    (React)    │     REST API      │  (ASP.NET)    │                 │   (SQLite)    │
│               │                   │               │                 │               │
└───────────────┘                   └───────────────┘                 └───────────────┘
```

## Архитектура фронтенда

Фронтенд построен на основе компонентного подхода React с использованием современных практик разработки:

### Структура каталогов фронтенда

```
src/
├── components/              # React компоненты
│   ├── common/              # Общие компоненты (кнопки, формы, модальные окна)
│   ├── layout/              # Компоненты разметки (шапка, подвал, основной контейнер)
│   └── pages/               # Компоненты страниц
│       ├── Home/            # Главная страница
│       ├── Catalog/         # Страница каталога товаров
│       ├── ProductDetails/  # Страница с детальной информацией о товаре
│       ├── Cart/            # Корзина
│       ├── Checkout/        # Оформление заказа
│       ├── Account/         # Личный кабинет
│       └── Admin/           # Административная панель
├── redux/                   # Управление состоянием
│   ├── actions/             # Action creators
│   ├── reducers/            # Reducers
│   ├── store.js             # Конфигурация Redux store
│   └── types.js             # Константы типов действий
├── services/                # Сервисы для работы с API
│   ├── api.js               # Базовая настройка axios
│   ├── authService.js       # Сервис для аутентификации
│   ├── productService.js    # Сервис для работы с товарами
│   └── cartService.js       # Сервис для работы с корзиной
├── utils/                   # Вспомогательные функции
│   ├── formatters.js        # Форматирование данных (цены, даты и т.д.)
│   └── validators.js        # Валидация форм
├── styles/                  # CSS/SCSS стили
│   ├── global.scss          # Глобальные стили
│   ├── variables.scss       # Переменные (цвета, размеры и т.д.)
│   └── mixins.scss          # Миксины для SCSS
├── assets/                  # Статические ресурсы (изображения, шрифты)
├── App.js                   # Корневой компонент приложения
├── index.js                 # Точка входа
└── routes.js                # Конфигурация маршрутов
```

### Основные компоненты фронтенда:

1. **React** - библиотека для создания пользовательских интерфейсов
2. **React Router** - маршрутизация на стороне клиента
3. **Redux** - управление глобальным состоянием приложения
4. **Axios** - HTTP-клиент для выполнения запросов к API
5. **Jest и React Testing Library** - инструменты для тестирования

### Архитектурные паттерны фронтенда:

1. **Компонентный подход** - разделение UI на независимые, переиспользуемые компоненты
2. **Flux-архитектура** (через Redux) - однонаправленный поток данных
3. **Container/Presentational Pattern** - разделение компонентов на контейнеры (логика) и презентационные (UI)
4. **Hooks** - использование функциональных компонентов и хуков для управления состоянием и эффектами

## Архитектура бэкенда

Бэкенд построен на основе ASP.NET Core с использованием паттерна MVC и многослойной архитектуры:

### Структура каталогов бэкенда

```
Backend/
├── Controllers/             # API контроллеры
│   ├── AuthController.cs    # Аутентификация и авторизация
│   ├── ProductsController.cs# Управление товарами
│   ├── CartController.cs    # Управление корзиной
│   └── OrdersController.cs  # Управление заказами
├── Models/                  # Модели данных
│   ├── BaseProduct.cs       # Базовый класс для товаров
│   ├── Game.cs              # Модель игры
│   ├── GameConsole.cs       # Модель консоли
│   ├── Accessory.cs         # Модель аксессуара
│   ├── User.cs              # Модель пользователя
│   ├── Order.cs             # Модель заказа
│   └── CartItem.cs          # Модель элемента корзины
├── Data/                    # Работа с базой данных
│   ├── ApplicationDbContext.cs # Контекст базы данных
│   ├── DbInitializer.cs     # Инициализация базы данных
│   └── Seeds/               # Данные для заполнения БД
│       ├── GameSeedData.cs  # Данные для игр
│       └── ConsoleSeedData.cs # Данные для консолей
├── Services/                # Бизнес-логика
│   ├── AuthService.cs       # Сервис аутентификации
│   ├── ProductService.cs    # Сервис товаров
│   └── OrderService.cs      # Сервис заказов
├── Repositories/            # Доступ к данным
│   ├── IRepository.cs       # Интерфейс репозитория
│   ├── Repository.cs        # Базовый репозиторий
│   └── ProductRepository.cs # Репозиторий товаров
├── DTOs/                    # Объекты передачи данных
│   ├── ProductDTO.cs        # DTO для товаров
│   └── OrderDTO.cs          # DTO для заказов
├── Middleware/              # Промежуточное ПО
│   └── ErrorHandlingMiddleware.cs # Обработка ошибок
├── Program.cs               # Точка входа
└── appsettings.json         # Настройки приложения
```

### Основные компоненты бэкенда:

1. **ASP.NET Core** - фреймворк для создания веб-приложений
2. **Entity Framework Core** - ORM для работы с базой данных
3. **Identity** - система аутентификации и авторизации
4. **SQLite** - легковесная база данных
5. **AutoMapper** - маппинг объектов между слоями
6. **Swagger/OpenAPI** - документирование API

### Архитектурные паттерны бэкенда:

1. **MVC (Model-View-Controller)** - разделение данных, представления и логики
2. **Repository Pattern** - абстракция доступа к данным
3. **Dependency Injection** - внедрение зависимостей
4. **Unit of Work** - управление транзакциями
5. **DTO (Data Transfer Objects)** - объекты для передачи данных между слоями

## Модель данных

### Основные сущности:

1. **BaseProduct** - базовый класс для всех товаров
   - Id: уникальный идентификатор
   - Name: название товара
   - Description: описание товара
   - Price: цена
   - ImageUrl: путь к изображению
   - InStock: количество на складе

2. **Game** (наследует BaseProduct)
   - Genre: жанр игры
   - Publisher: издатель
   - ReleaseDate: дата выпуска
   - Platform: платформа (PS5, PS4 и т.д.)
   - AgeRating: возрастной рейтинг

3. **GameConsole** (наследует BaseProduct)
   - Manufacturer: производитель
   - StorageSize: объем памяти
   - Color: цвет
   - IsDigitalOnly: только цифровая версия
   - Specifications: технические характеристики

4. **Accessory** (наследует BaseProduct)
   - Type: тип аксессуара
   - CompatibleWith: совместимость с консолями
   - Manufacturer: производитель

5. **User**
   - Id: уникальный идентификатор
   - Username: имя пользователя
   - Email: электронная почта
   - PasswordHash: хеш пароля
   - Role: роль (пользователь, администратор)
   - RegistrationDate: дата регистрации

6. **Order**
   - Id: уникальный идентификатор
   - UserId: идентификатор пользователя
   - OrderDate: дата заказа
   - TotalAmount: общая сумма
   - Status: статус заказа
   - DeliveryAddress: адрес доставки
   - PaymentMethod: способ оплаты
   - OrderItems: список товаров в заказе

7. **CartItem**
   - Id: уникальный идентификатор
   - UserId: идентификатор пользователя
   - ProductId: идентификатор товара
   - Quantity: количество
   - DateAdded: дата добавления в корзину

### Схема базы данных

```
┌───────────────┐     ┌───────────────┐     ┌───────────────┐
│   BaseProduct │     │     User      │     │     Order     │
├───────────────┤     ├───────────────┤     ├───────────────┤
│ Id            │     │ Id            │     │ Id            │
│ Name          │     │ Username      │     │ UserId        │
│ Description   │     │ Email         │     │ OrderDate     │
│ Price         │     │ PasswordHash  │     │ TotalAmount   │
│ ImageUrl      │     │ Role          │     │ Status        │
│ InStock       │     │ RegDate       │     │ Address       │
└───────┬───────┘     └───────┬───────┘     └───────┬───────┘
        │                     │                     │
        │                     │                     │
┌───────┴───────┐     ┌───────┴───────┐     ┌───────┴───────┐
│     Game      │     │   CartItem    │     │   OrderItem   │
├───────────────┤     ├───────────────┤     ├───────────────┤
│ Genre         │     │ Id            │     │ Id            │
│ Publisher     │     │ UserId        │     │ OrderId       │
│ ReleaseDate   │     │ ProductId     │     │ ProductId     │
│ Platform      │     │ Quantity      │     │ Quantity      │
│ AgeRating     │     │ DateAdded     │     │ Price         │
└───────────────┘     └───────────────┘     └───────────────┘
        │
┌───────┴───────┐
│  GameConsole  │
├───────────────┤
│ Manufacturer  │
│ StorageSize   │
│ Color         │
│ IsDigitalOnly │
│ Specifications│
└───────────────┘
        │
┌───────┴───────┐
│   Accessory   │
├───────────────┤
│ Type          │
│ CompatibleWith│
│ Manufacturer  │
└───────────────┘
```

## API эндпоинты

### Аутентификация

- `POST /api/auth/register` - Регистрация нового пользователя
- `POST /api/auth/login` - Авторизация пользователя
- `POST /api/auth/logout` - Выход из системы
- `GET /api/auth/user` - Получение информации о текущем пользователе

### Товары

- `GET /api/products` - Получение списка всех товаров
- `GET /api/products/{id}` - Получение информации о конкретном товаре
- `POST /api/products` - Создание нового товара (только для администраторов)
- `PUT /api/products/{id}` - Обновление товара (только для администраторов)
- `DELETE /api/products/{id}` - Удаление товара (только для администраторов)
- `GET /api/games` - Получение списка игр
- `GET /api/consoles` - Получение списка консолей
- `GET /api/accessories` - Получение списка аксессуаров

### Корзина

- `GET /api/cart` - Получение содержимого корзины
- `POST /api/cart` - Добавление товара в корзину
- `PUT /api/cart/{id}` - Изменение количества товара в корзине
- `DELETE /api/cart/{id}` - Удаление товара из корзины
- `DELETE /api/cart` - Очистка корзины

### Заказы

- `GET /api/orders` - Получение списка заказов пользователя
- `GET /api/orders/{id}` - Получение информации о конкретном заказе
- `POST /api/orders` - Создание нового заказа
- `PUT /api/orders/{id}/status` - Изменение статуса заказа (только для администраторов)

## Безопасность

1. **Аутентификация и авторизация**:
   - JWT (JSON Web Tokens) для аутентификации
   - Ролевая модель авторизации (пользователь, администратор)
   - Хеширование паролей с использованием BCrypt

2. **Защита от уязвимостей**:
   - Защита от CSRF-атак
   - Защита от XSS-атак
   - Проверка входных данных и валидация на стороне сервера
   - HTTPS для шифрования данных при передаче

## Масштабируемость

Архитектура проекта позволяет легко масштабировать его в будущем:

1. **Горизонтальное масштабирование**:
   - Возможность запуска нескольких экземпляров API
   - Балансировка нагрузки между экземплярами

2. **Вертикальное масштабирование**:
   - Переход на более мощную СУБД (например, PostgreSQL или SQL Server)
   - Оптимизация запросов к базе данных

3. **Модульность**:
   - Возможность добавления новых функций без изменения существующего кода
   - Четкое разделение ответственности между компонентами 